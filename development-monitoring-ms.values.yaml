# Development values for a Quarkus microservice (monitoring-ms)
# Path example: platform-gitops/values/development/ms/monitoring-ms.yaml

x-deploy:
  namespace: "sfs-dev"
  releaseName: "monitoring-ms"
  argocdApp: "monitoring-ms-development"
  # chart: "charts/quarkus-ms-base"  # optional (defaults to ms chart in CI)

image:
  repository: "registry.saas.cagip.group.gca/sfs/monitoring-ms"
  tag: "1.0.0"
  pullPolicy: IfNotPresent
  pullSecrets: [] # e.g. ["regcred"]

replicaCount: 1

serviceAccount:
  create: true
  name: ""
  annotations: {}

podAnnotations: {}
podLabels: {}

podSecurityContext:
  runAsNonRoot: true
  fsGroup: 1001

securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: false
  capabilities:
    drop: ["ALL"]

service:
  type: ClusterIP
  port: 8080

ingress:
  enabled: true
  className: "nginx"
  annotations: {}
  hosts:
    - host: "monitoring-ms.dev.example.local"
      paths:
        - path: /
          pathType: Prefix
  tls: []

resources:
  requests:
    cpu: "100m"
    memory: "256Mi"
  limits:
    cpu: "500m"
    memory: "512Mi"

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 4
  targetCPUUtilizationPercentage: 75

nodeSelector: {}
tolerations: []
affinity: {}

env:
  - name: QUARKUS_PROFILE
    value: dev
  - name: QUARKUS_HTTP_PORT
    value: "8080"
  - name: QUARKUS_LOG_LEVEL
    value: INFO
  - name: JAVA_TOOL_OPTIONS
    value: "-XX:MaxRAMPercentage=75.0 -Dfile.encoding=UTF-8"

config:
  application.yaml: |
    quarkus:
      http:
        cors: true
      log:
        category:
          "com.cagip":
            level: DEBUG
      datasource:
        db-kind: postgresql
        jdbc:
          url: "jdbc:postgresql://postgres.sfs-dev.svc.cluster.local:5432/monitoring"
        username: "monitoring"

secrets:
  existingSecretName: "monitoring-ms-dev-secrets"
  envFromSecret:
    - name: DB_PASSWORD
      key: DB_PASSWORD
    - name: OIDC_CLIENT_SECRET
      key: OIDC_CLIENT_SECRET

probes:
  readiness:
    enabled: true
    path: /q/health/ready
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 2
    failureThreshold: 6
  liveness:
    enabled: true
    path: /q/health/live
    initialDelaySeconds: 20
    periodSeconds: 15
    timeoutSeconds: 2
    failureThreshold: 6

extraVolumes: []
extraVolumeMounts: []
